---
title: "RiskSust"
author: "А.Ю. Митрофанов"
date: "22 10 2019"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Материалы к статье:

Оценка риска потери устойчивости социально-экономического развития муниципального образования с помощью эксполинейной функции

## загрузка вспомогательных функций

```{r}
source("catvec.R")
source("round_as_se.R")
source("plot1.R")
source("lines1.R")
source("legend1.R")

```

## исходные данные (г. Саратов)

| № п/п | Переменная | Показатель |
|:-----:|:----------:|------------|
| 1     | POP        | Оценка численности населения на 1 января текущего года, человек |
| 2     | BBR        | Общий коэффициент рождаемости, промилле |
| 3     | BMR        | Общий коэффициент смертности, промилле |
| 4     | MRO        | Среднесписочная численность работников организаций (с 2017 г. по по okved2), человек |
| 5     | PRF        | Прибыль (убыток) до налогообложения отчетного года, тыс. рублей |
| 6     | HSCON      | Введено в действие жилых домов на территории муниципального образования, кв. м общей площади |

&nbsp;

```{r}
(df <- rio::import("Saratov.txt"))
```

## графики динамики показателей

```{r fig.width=8, fig.height=5}
plot1(POP ~ year, data = df, type = "o", lwd = 2)
grid()
```

```{r fig.width=8, fig.height=5}
plot1(BBR ~ year, data = df, type = "o", lwd = 2)
grid()
```

```{r fig.width=8, fig.height=5}
plot1(BMR ~ year, data = df, type = "o", lwd = 2)
grid()
```

```{r fig.width=8, fig.height=5}
plot1(MRO ~ year, data = df, type = "o", lwd = 2)
grid()
```

```{r fig.width=8, fig.height=5}
plot1(PRF ~ year, data = df, type = "o", lwd = 2)
grid()
```

```{r fig.width=8, fig.height=5}
plot1(HSCON ~ year, data = df, type = "o", lwd = 2)
grid()
```

## загрузка основных функций

```{r}
source("est_expolin.R")
source("analyse_table_expolin.R")
```

## форматирование данных для применения analyse_table_expolin()

```{r}
df1 <- t(df)
df1 <- data.frame(df1)
colnames(df1) <- df1["year", ]
df1 <- df1[-1, ]
df1 <- cbind(Показатели = c("Оценка численности населения на 1 января текущего года", 
    "Общий коэффициент рождаемости", "Общий коэффициент смертности", 
    "Среднесписочная численность работников организаций (с 2017 г. по по okved2)", 
    "Прибыль (убыток) до налогообложения отчетного года", 
    "Введено в действие жилых домов на территории муниципального образования"), 
    `Ед. измерения` = c("человек", "промилле", "промилле", 
        "человек", "тыс. рублей", "кв. м общей площади"), 
    df1)
df1
```

## анализ риска потери устойчивости для 6 показателей по г. Саратову

```{r fig.width=8, fig.height=10}
resu <- analyse_table_expolin(df1)
```

\newpage

## результаты анализа

```{r}
knitr::kable(resu)
```

